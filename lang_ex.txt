int fib(int n) {
    int a = 1, b = 1;

    int i = 1;
    while (i < n) {
        int temp = b;
        b = a;
        a = temp;
        a = a + b;

        i = i + 1;
    }

    return a;
}

int main() {
    int f = fib(10);
    print(f);

    return 0;
}


: fib 

PUSH 0
POPR RAX 
POPM [RAX] ; n

PUSH 1
PUSH 1
POPR RAX
POPM [RAX] ; a

PUSH 1
PUSH 2
POPR RAX
POPM [RAX] ; b

PUSH 1
PUSH 3
POPR RAX
POPM [RAX] ; i 

: begif_1

PUSH 3
POPR RAX
PUSHM [RAX] ; i

PUSH 0
POPR RAX 
PUSHM [RAX] ; n

JBE endif_1

PUSH 2
POPR RAX 
PUSHM [RAX] ; b

PUSH 4
POPR RAX
POPM [RAX] ; temp

PUSH 1
POPR RAX
PUSHM [RAX] ; a

PUSH 2
POPR RAX 
POPM [RAX] ; b

PUSH 4
POPR RAX
PUSHM [RAX] ; temp

PUSH 1
POPR RAX
POPM [RAX] ; a

PUSH 1
POPR RAX
PUSHM [RAX] ; a

PUSH 2
POPR RAX 
PUSHM [RAX] ; b

ADD

PUSH 1
POPR RAX
POPM [RAX] ; a

JMP begif_1

: endif_1

PUSH 1
POPR RAX
PUSHM [RAX] ; a

RET 


MAIN 

PUSH 10
CALL fib 

PUSH 5
POPR RAX 
POPM [RAX] ; f   

PUSH 5
POPR RAX 
PUSHM [RAX] ; f   

OUT 

HLT